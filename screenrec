#!/usr/bin/env bash
# ðŸŽ¥ aserdev's wf-recorder Rofi menu ðŸ’€
# written at 3AM because why not ruin my sleep schedule
# dependencies: wf-recorder, rofi, grimblast, slurp (aka: pain)

OUTPUT="$HOME/Videos/recording-$(date +%Y%m%d-%H%M%S).mp4"

# ðŸ§  the unholy menu
MENU=$(printf "ðŸŽ¥ Record Fullscreen\nðŸ“¹ Record Area\nðŸ›‘ Stop Recording\nðŸ“· full screenshot\nðŸ“¸ area screenshot" \
    | rofi -dmenu -p "Screen Recorder (pls don't break):")

case "$MENU" in
    "ðŸ“· full screenshot")
        sleep 1
        notify-send "ðŸ“¸ Screenshot" "Full screen captured ðŸ§"
        grimblast copysave screen --notify || notify-send "ðŸ’€ grimblast died" "skill issue"
        ;;

    "ðŸ“¸ area screenshot")
        sleep 1
        notify-send "ðŸ“¸ Screenshot" "Select area like it's Minecraft"
        grimblast copysave area --notify || notify-send "ðŸ’€ grimblast exploded" "try again ig"
        ;;

    "ðŸŽ¥ Record Fullscreen")
        sleep 1
        notify-send "ðŸ“¹ Recording Started" "Fullscreen mode activated, don't do anything sus"
        wf-recorder -f "$OUTPUT" & disown || notify-send "ðŸ’€ wf-recorder ragequit"
        ;;

    "ðŸ“¹ Record Area")
        sleep 1
        notify-send "ðŸ“¹ Recording" "Pick your poison (select area)"
        wf-recorder -g "$(slurp)" -f "$OUTPUT" & disown \
            || notify-send "ðŸ’€ wf-recorder gave up" "L"
        ;;

    "ðŸ›‘ Stop Recording")
        if pgrep -x wf-recorder >/dev/null; then
            pkill -SIGINT wf-recorder
            notify-send "ðŸ›‘ Recording Stopped" "Saved to ~/Videos (go check it lazy ðŸ’€)"
        else
            notify-send "âš ï¸ Bro..." "There's literally nothing recording ðŸ’€"
        fi
        ;;

    *)
        echo "ok u canceled, cringe" >/dev/null
        ;;
esac
